<!DOCTYPE html>
<html>
<head>
  <title>Simple Map</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="map"></div>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
	<script src="./frameworks/react.js"></script>
	<script src="./frameworks/JSXTransformer.js"></script>
	<script type="text/jsx">
		var locations = [
			{
				id: 0,
				name: 'Houston',
				location: {
					latt: 29.76, 
					long: -95.38
				}, 
				zoom: 8
			},
			{
				id: 1,
				name: 'Austin',
				location: {
					latt: 30.28, 
					long: -97.76
				}, 
				zoom: 8
			}
		];
		var Body = React.createClass({
			getInitialState: function(){
				return ({currentLoc: locations[0]})
			},
			render: function(){
				return (
					<div id="wrapper">
						<Nav click={this.click}/>
						<GoogleMap currentLoc={this.state.currentLoc}/>
					</div>
				)
			},
			click:function(){s
				var id = this.state.currentLoc.id;
				id = (id + 1) % locations.length;
				this.setState({currentLoc: locations[id]})
			}
		});

		var Nav = React.createClass({
			render: function(){
				return (
					<div className='navbar'>
					<input className="pure-button" type='button' value='click me' onClick={this.clicker} />
					</div>
				)
			},
			clicker: function(){
				this.props.click();
			}
		});

		var GoogleMap = React.createClass({
			render: function(){
				return (
					<div>
						<div className='maps'>
						<div id='mapA' className='map' text-align="right"/>
						</div>
						<LocationList />
					</div>
				)
			},
			componentDidMount: function(){
				this.setLoc();
			},
			componentDidUpdate: function(){
				this.setLoc();
			},
			setLoc: function(){
				var loc = this.props.currentLoc;
				var latlong = loc.location;
				var mapOptions = {
					zoom: loc.zoom,
					center: new google.maps.LatLng(latlong.latt, latlong.long)
				};
				new google.maps.Map(document.getElementById('mapA'), mapOptions);
			}
		});

		var LocationRow = React.createClass({
			render: function(){
				var loc = this.props.data;
				return (
					<tr>
						<td>{loc.name}</td>
						<td>{loc.location.latt}</td>
						<td>{loc.location.latt}</td>
					</tr>
				)
			}
		});

		var LocationInput = React.createClass({
			render: function(){
				return (
					<tr>
						<td><input /></td>
						<td><input /></td>
						<td><input /></td>
					</tr>
				)
			}
		})

		var LocationList = React.createClass({
			render: function(){
				var arr = [];
				for(var i = 0, iLen = locations.length; i < iLen; i++){	
					arr.push(<LocationRow data={locations[i]} />)
				}
				return (
					<table className="pure-table">
						<thead>
						<tr>
							<th>City</th>
							<th>Lattitude</th>
							<th>Longitude</th>
						</tr>
						</thead>
						{arr}
						<LocationInput />
					</table>
				)
			}
		})

		function initialize() {
			React.render(
				<Body />,
				document.getElementById('map')
			);
		};

		google.maps.event.addDomListener(window, 'load', initialize);

	</script>
</body>
</html>